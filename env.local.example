# ==========================================================================
# LOCAL DEVELOPMENT CONFIGURATION
# ==========================================================================
# Copy this file to .env.local and update with your actual values
# This configuration allows you to run agent-manager locally while
# connecting to production backend services for testing.

# ==========================================================================
# BACKEND SERVICES (Production LXC Containers)
# ==========================================================================

# Python Agent Server
NEXT_PUBLIC_AGENT_API_URL=http://10.96.200.202:8000

# Ingest API (for document management)
NEXT_PUBLIC_INGEST_API_URL=http://10.96.200.206:8002

# ==========================================================================
# AUTHENTICATION
# ==========================================================================

# AI Portal URL (where users authenticate)
# Use production portal for SSO flow
NEXT_PUBLIC_AI_PORTAL_URL=http://10.96.200.201:3000

# AuthZ Service (for token exchange)
# Use localhost proxy (nginx routes /api/authz to the authz service)
AUTHZ_BASE_URL=https://localhost/api/authz

# Agent-manager's client credentials
# These must be registered with the authz service
# 
# To register agent-manager with authz:
#   1. Run: cd ../ai-portal && ./scripts/register-authz-clients.sh
#   2. Copy the generated AUTHZ_CLIENT_SECRET for agent-manager here
#
# Or manually register via API:
#   curl -X POST http://10.96.200.210:8010/internal/clients \
#     -H "Content-Type: application/json" \
#     -d '{"client_id": "agent-manager", "client_secret": "<your-secret>", "allowed_audiences": ["agent-api", "ingest-api", "search-api"]}'
#
AUTHZ_CLIENT_ID=agent-manager
AUTHZ_CLIENT_SECRET=your-secret-here

# ==========================================================================
# APPLICATION
# ==========================================================================

# Base path for routing
# For nginx proxy at /agents, set to /agents
# For direct access (no proxy), leave empty
NEXT_PUBLIC_BASE_PATH=/agents

# App URL (for redirects)
# When using nginx proxy, use the proxy URL
# When running directly, use http://localhost:3006
NEXT_PUBLIC_APP_URL=http://localhost:3006

# Node environment
NODE_ENV=development

# Port (use 3006 to match nginx proxy configuration)
PORT=3006

# ==========================================================================
# TEST USER (Local Development Only)
# ==========================================================================

# Test user credentials for local development without SSO flow
# When these are set, you can test directly without going through ai-portal
# These bypass the SSO token exchange and directly request authz tokens
TEST_USER_ID=696ca76f-5e94-43d6-a628-2e5104fc6ba9
TEST_USER_EMAIL=test@busibox.local

# ==========================================================================
# OPTIONAL CONFIGURATION
# ==========================================================================

# Enable debug logging
DEBUG=true

# SSE connection timeout (milliseconds)
SSE_TIMEOUT=30000

# Maximum concurrent SSE streams
MAX_SSE_STREAMS=100

# ==========================================================================
# SETUP INSTRUCTIONS
# ==========================================================================
# 
# 1. Copy this file to .env.local:
#    cp env.local.example .env.local
#
# 2. Get authz credentials:
#    - Run: cd ../ai-portal && ./scripts/register-authz-clients.sh
#    - Or contact admin for AUTHZ_CLIENT_SECRET
#
# 3. Start the dev server:
#    npm run dev
#
# 4. Test directly (without SSO):
#    - Go to http://localhost:3006
#    - Will automatically use TEST_USER credentials
#    - No need to go through ai-portal
#
# 5. Test with SSO flow:
#    - Go to http://10.96.200.201:3000
#    - Log in
#    - Click on Agent Manager app
#    - Should redirect to http://localhost:3006 with SSO token
#
# 6. Troubleshooting:
#    - Check browser console for errors
#    - Check terminal for server logs
#    - Verify network access to LXC containers (10.96.200.x)
#    - Verify authz credentials are correct
