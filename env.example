# =============================================================================
# AGENT-MANAGER LOCAL DEVELOPMENT CONFIGURATION
# =============================================================================
# Copy this file to .env.local for local development:
#   cp env.example .env.local
#
# For Docker/Proxmox deployments, environment variables are automatically
# generated from Ansible vault - DO NOT use this file for those deployments.
#
# This configuration allows you to run agent-manager locally while connecting
# to backend services (local Docker or remote Proxmox).

# =============================================================================
# BACKEND SERVICES
# =============================================================================

# Python Agent API
# Local Docker:  http://localhost:8000
# Proxmox:       http://10.96.200.202:8000 (prod) or http://10.96.201.202:8000 (staging)
NEXT_PUBLIC_AGENT_API_URL=http://localhost:8000

# Ingest API (for document management)
# Local Docker:  http://localhost:8002
# Proxmox:       http://10.96.200.206:8002 (prod) or http://10.96.201.206:8002 (staging)
NEXT_PUBLIC_INGEST_API_URL=http://localhost:8002

# =============================================================================
# AUTHENTICATION & SSO
# =============================================================================

# AI Portal URL (where users authenticate)
# Local:         http://localhost:3000
# Proxmox:       http://10.96.200.201:3000 (prod) or http://10.96.201.201:3000 (staging)
NEXT_PUBLIC_AI_PORTAL_URL=http://localhost:3000

# AuthZ Service (for token exchange)
# Local Docker:  http://localhost:8010 or https://localhost/api/authz (via nginx)
# Proxmox:       http://10.96.200.210:8010 (prod) or http://10.96.201.210:8010 (staging)
AUTHZ_BASE_URL=http://localhost:8010

# Agent-manager OAuth credentials
# These must be registered with the AuthZ service
# 
# To register with local AuthZ:
#   1. Make sure authz service is running (docker compose up authz-api)
#   2. Register the client:
#      curl -X POST http://localhost:8010/internal/clients \
#        -H "Content-Type: application/json" \
#        -d '{"client_id": "agent-manager", "client_secret": "local-dev-secret", "allowed_audiences": ["agent-api", "ingest-api", "search-api"]}'
#   3. Use the same client_secret here:
AUTHZ_CLIENT_ID=agent-manager
AUTHZ_CLIENT_SECRET=local-dev-secret

# SSO Configuration
SSO_JWT_SECRET=dev-sso-secret-change-in-production
SSO_TOKEN_EXPIRY=900

# =============================================================================
# LITELLM (AI MODEL PROXY)
# =============================================================================

# LiteLLM service URL
# Local Docker:  http://localhost:4000/v1
# Proxmox:       http://10.96.200.207:4000/v1 (prod) or http://10.96.201.207:4000/v1 (staging)
LITELLM_BASE_URL=http://localhost:4000/v1

# LiteLLM API key (if required by your LiteLLM configuration)
LITELLM_API_KEY=sk-local-dev-key

# =============================================================================
# APPLICATION CONFIGURATION
# =============================================================================

# Node environment
NODE_ENV=development

# Port for local dev server
PORT=3001

# Base path for routing
# For nginx proxy at /agents: set to /agents
# For direct access: leave empty or set to ""
NEXT_PUBLIC_BASE_PATH=/agents

# App URL (for redirects and links)
# Local direct:  http://localhost:3001
# Local nginx:   https://localhost/agents
NEXT_PUBLIC_APP_URL=http://localhost:3001/agents

# Deployment mode (informational)
DEPLOYMENT_MODE=local

# =============================================================================
# OPTIONAL: EMAIL SERVICE (RESEND)
# =============================================================================
# Only needed if agent-manager sends emails (usually handled by ai-portal)

# RESEND_API_KEY=re_your_api_key_here
# EMAIL_FROM=Agent Manager <noreply@your-domain.com>

# =============================================================================
# OPTIONAL: AUTHZ ADMIN TOKEN
# =============================================================================
# Only needed for admin operations on the AuthZ service

# AUTHZ_ADMIN_TOKEN=local-admin-token

# =============================================================================
# OPTIONAL: TLS/SSL CONFIGURATION
# =============================================================================

# Skip TLS verification for self-signed certs in local development
# WARNING: NEVER use this in production!
NODE_TLS_REJECT_UNAUTHORIZED=0

# =============================================================================
# OPTIONAL: DEBUGGING & MONITORING
# =============================================================================

# Enable debug logging
DEBUG=true

# SSE connection timeout (milliseconds)
SSE_TIMEOUT=30000

# Maximum concurrent SSE streams
MAX_SSE_STREAMS=100

# =============================================================================
# OPTIONAL: OAUTH SERVICE AUDIENCES
# =============================================================================
# Used for token scope management

AGENT_API_AUD=https://busibox.local/agent
SEARCH_API_AUD=https://busibox.local/search
DOCUMENTS_API_AUD=https://busibox.local/documents

# =============================================================================
# SETUP INSTRUCTIONS
# =============================================================================
#
# OPTION 1: Local Docker Stack (Recommended for Development)
# ----------------------------------------------------------
# 1. Copy this file:
#    cp env.example .env.local
#
# 2. Start all services with Docker:
#    cd ../busibox
#    make docker-up
#
# 3. Register agent-manager with AuthZ (one-time):
#    curl -X POST http://localhost:8010/internal/clients \
#      -H "Content-Type: application/json" \
#      -d '{"client_id": "agent-manager", "client_secret": "local-dev-secret", "allowed_audiences": ["agent-api", "ingest-api", "search-api"]}'
#
# 4. Start agent-manager dev server:
#    npm run dev
#
# 5. Access at http://localhost:3001
#
#
# OPTION 2: Connect to Remote Proxmox Services
# ---------------------------------------------
# 1. Copy this file:
#    cp env.example .env.local
#
# 2. Update service URLs to point to Proxmox:
#    NEXT_PUBLIC_AGENT_API_URL=http://10.96.200.202:8000
#    NEXT_PUBLIC_INGEST_API_URL=http://10.96.200.206:8002
#    NEXT_PUBLIC_AI_PORTAL_URL=http://10.96.200.201:3000
#    AUTHZ_BASE_URL=http://10.96.200.210:8010
#    LITELLM_BASE_URL=http://10.96.200.207:4000/v1
#
# 3. Get AuthZ credentials from admin
#
# 4. Start agent-manager:
#    npm run dev
#
# 5. Access at http://localhost:3001
#
#
# PRODUCTION DEPLOYMENTS
# ----------------------
# For Docker/Proxmox production deployments, DO NOT use this file.
# Environment variables are automatically generated from Ansible vault.
# See: ../busibox/provision/ansible/group_vars/all/apps.yml
